<html>
<head>
  <title>Telegram Mini App</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
  <script>
    const tg = window.Telegram.WebApp;
    tg.ready();

    document.body.style.display = "flex";
    document.body.style.flexDirection = "column";
    document.body.style.alignItems = "center";
    document.body.style.justifyContent = "center";
    document.body.style.fontFamily = "sans-serif";
    document.body.style.padding = "20px";

    const user = tg.initDataUnsafe?.user;
    console.log("User info:", user);

    if (user) {
      document.body.insertAdjacentHTML(
        "beforeend",
        `<img src="${user.photo_url}" width="150" style="height:auto; border-radius:50%; margin-bottom:15px;">
         <p>Welcome, ${user.first_name}! (id: ${user.id})</p>
         <input type="text" id="input" placeholder="Type whatever you want">
         <button id="btn">Submit</button>`
      );
    } else {
      document.body.insertAdjacentHTML("beforeend", `<p>No Telegram user data found.</p>`);
    }

      document.getElementById("btn").onclick = () => {
        const userInput = document.getElementById("input").value;
        tg.sendData(JSON.stringify({
        action: "input_save",
        value: userInput
      }));
      tg.close();
    };


    function applyTheme() {
      const theme = tg.colorScheme;
      if (theme === "dark") {
        document.body.style.backgroundColor = "#1a1a1a";
        document.body.style.color = "#ffffff";
      } else {
        document.body.style.backgroundColor = "#ffffff";
        document.body.style.color = "#000000";
      }
    }

    applyTheme();
    tg.onEvent("themeChanged", applyTheme);
  </script>
  <p style="color:gray; position:absolute; bottom:0">0.4</p>
</body>
</html>
